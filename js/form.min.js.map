{"version":3,"names":[],"mappings":"","sources":["form.js"],"sourcesContent":["\"use strict\";\nwindow.onload = () => {\n    // opec/close form\n    (document.getElementById(\"reg-code\").onclick = function () {\n      document.getElementById(\"overlay\").classList.toggle(\"overlay--active\"),\n        document.getElementById(\"modal\").classList.toggle(\"modal--active\");\n    }),\n    (document.getElementById(\"close-btn\").onclick = function () {\n      document.getElementById(\"overlay\").classList.remove(\"overlay--active\"),\n        document.getElementById(\"modal\").classList.remove(\"modal--active\");\n    }),\n    document.getElementById(\"overlay\").addEventListener(\"click\", function (e) {\n      \"overlay\" == e.target.id &&\n        (this.classList.remove(\"overlay--active\"),\n          document.getElementById(\"modal\").classList.remove(\"modal--active\"));\n    });\n\n\n    //Set country\n    let\n        countries   = [],\n        xhr         = new XMLHttpRequest(),\n        select_List = document.getElementById(\"select-list\");\n    //Load countries\n    xhr.open('GET', \"countries.txt\");\n    xhr.responseType = 'text';\n    xhr.onload = () => {\n        countries = xhr.response.split(', ');\n        for(let country of countries){\n            let option = document.createElement(\"option\");\n            //option.className = \"select-item\";\n            option.innerText = country;\n            option.value = country;\n\n            //Add element to autocomplete\n            select_List.appendChild(option);\n        }\n    };\n\n    xhr.send();\n\n    //Masked Inputs\n    $(\".phone\").mask(\"380999999999\", { placeholder: \"380_________\" });\n\n    //Send form\n    let\n        formBlock = document.getElementsByTagName(\"form\")[0],\n        formBlock_CodeInput = formBlock.querySelector(\"input[name='code']\");\n\n    formBlock.addEventListener(\"submit\", async(event) => {\n\n        event.preventDefault();\n\n        grecaptcha.ready(function() {\n            grecaptcha.execute('6LchsEcbAAAAAAP2kJyZ05L-V82IoKp9E43qU19M', {action: 'submit'}).then(function(token) {\n\n                //Values\n                let\n                    xhr = new XMLHttpRequest(),\n                    data = new FormData(event.target),\n                    url = formBlock.getAttribute(\"action\"),\n                    method = formBlock.getAttribute('method'),\n                    result_Block = formBlock.querySelector(\".result-text\"),\n                    submit_button = formBlock.querySelector(\"input[type='submit'], button[type='submit']\"),\n                    loader = formBlock.getElementsByClassName(\"loader\")[0];\n\n                //Add token\n                data.append('g-recaptcha-response', token);\n\n                //Check country\n                if(countries.indexOf(data.get(\"selected_country\")) == -1){\n                    formBlock.querySelector(\"input[name='selected_country']\").value = \"\";\n                    return false;\n                }\n\n                //Send request\n                xhr.open(method, url);\n                xhr.responseType = 'text';\n                xhr.setRequestHeader(\"Cache-Control\", \"no-cache\");\n                xhr.setRequestHeader(\"redirect\", \"follow\");\n                xhr.setRequestHeader(\"referrerPolicy\", \"no-referrer\");\n                xhr.setRequestHeader(\"mode\", \"cors\");\n                xhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\n                xhr.onload = function() {\n                    //Active submit-button\n                    submit_button.disabled = false;\n                    //Hide loader\n                    loader.classList.remove('loader--active');\n\n                    if (this.status >= 200 && this.status < 300) {\n                        result_Block.style.color = \"#44944A\";\n                    } else {\n                        result_Block.style.color = \"#F13A13\";\n\n                        //Clear input\n                        formBlock_CodeInput.value = null;\n                        //grecaptcha.reset();\n                    }\n                    result_Block.innerHTML = (this.status >= 500) ? \"Час очікування відповіді сервера минув\" : this.response;\n                }\n\n                xhr.send(data);\n\n                //Disable submit-button\n                submit_button.disabled = true;\n                //Show loader\n                loader.classList.add('loader--active');\n            });\n        });\n    });\n};\n\n\n"],"file":"form.min.js"}